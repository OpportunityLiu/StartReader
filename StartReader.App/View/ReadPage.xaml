<views:MvvmPage xmlns:views="using:Opportunity.MvvmUniverse.Views"
                x:Class="StartReader.App.View.ReadPage"
                x:Name="page"
                xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                xmlns:local="using:StartReader.App.View"
                xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                xmlns:ext="using:Microsoft.Toolkit.Uwp.UI.Extensions"
                SizeChanged="page_SizeChanged"
                NavigationCacheMode="Enabled"
                Title="{x:Bind getTitle(ViewModel.Current.Title, ViewModel.Current.VolumeTitle, ViewModel.Current.Book.Title), Mode=OneWay}"
                Padding="{x:Bind VisibleBounds, Mode=OneWay}"
                mc:Ignorable="d"
                Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

  <Grid>
    <ScrollViewer x:Name="svContent"
                  ViewChanged="svContent_ViewChanged"
                  ext:FrameworkElementExtensions.EnableActualSizeBinding="True">
      <StackPanel>
        <StackPanel x:Name="spPrevious"
                    Padding="0,20">
          <TextBlock Visibility="{x:Bind ViewModel.Previous, Mode=OneWay, Converter={StaticResource NullToCollpsedConverter}}"
                     Text="上一章节"
                     HorizontalAlignment="Center" />
          <TextBlock Visibility="{x:Bind ViewModel.Previous, Mode=OneWay, Converter={StaticResource NullToVisibleConverter}}"
                     Text="已经到达第一章"
                     HorizontalAlignment="Center" />
          <TextBlock Text="{x:Bind ViewModel.Previous.Title, Mode=OneWay, FallbackValue=''}"
                     HorizontalAlignment="Center" />
        </StackPanel>
        <RichTextBlock x:Name="rtbContent"
                       FontSize="28"
                       MinHeight="{x:Bind svContent.(ext:FrameworkElementExtensions.ActualHeight), Mode=OneWay}"
                       VerticalAlignment="Center"
                       DataContext="{x:Bind ViewModel.Current.Content, Mode=OneWay}"
                       DataContextChanged="rtbContent_DataContextChanged" />
        <StackPanel x:Name="spNext"
                    Padding="0,20">
          <TextBlock Visibility="{x:Bind ViewModel.Next, Mode=OneWay, Converter={StaticResource NullToCollpsedConverter}}"
                     Text="下一章节"
                     HorizontalAlignment="Center" />
          <TextBlock Visibility="{x:Bind ViewModel.Next, Mode=OneWay, Converter={StaticResource NullToVisibleConverter}}"
                     Text="已经到达最后一章"
                     HorizontalAlignment="Center" />
          <TextBlock Text="{x:Bind ViewModel.Next.Title, Mode=OneWay, FallbackValue=''}"
                     HorizontalAlignment="Center" />
        </StackPanel>
      </StackPanel>
    </ScrollViewer>
  </Grid>
</views:MvvmPage>
